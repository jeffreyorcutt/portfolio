{"paragraphs":[{"text":"import org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\n\nval spark = SparkSession.builder.appName(\"Temperature Analysis\").getOrCreate()\n\n// Start timer\nval startTime = System.nanoTime()\n\n// Load the data\nval df = spark.read.format(\"csv\").option(\"delimiter\", \";\").option(\"header\", \"false\").load(\"/user/maria_dev/measurements/measurements.txt\")\n\n// Rename the columns\nval measurements = df.toDF(\"city\", \"temperature\")\n\n// Convert the temperature column to float\nval measurementsFloat = measurements.withColumn(\"temperature\", col(\"temperature\").cast(\"float\"))\n\n// Calculate min, avg, and max temperatures\nval results = measurementsFloat.groupBy(\"city\").agg(\n  min(\"temperature\").alias(\"min_temp\"),\n  avg(\"temperature\").alias(\"avg_temp\"),\n  max(\"temperature\").alias(\"max_temp\")\n)\n\n// Save the results to a CSV file\nresults.write.option(\"header\", \"true\").csv(\"/user/maria_dev/scala_out.1b.csv\")\n\n// End timer and print the execution time\nval endTime = System.nanoTime()\nval duration = (endTime - startTime) / 1e9d\nprintln(s\"Execution time: $duration seconds\")","user":"anonymous","dateUpdated":"2024-04-10T21:56:07+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nspark: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@6ab6122e\nstartTime: Long = 5683417783062\ndf: org.apache.spark.sql.DataFrame = [_c0: string, _c1: string]\nmeasurements: org.apache.spark.sql.DataFrame = [city: string, temperature: string]\nmeasurementsFloat: org.apache.spark.sql.DataFrame = [city: string, temperature: float]\nresults: org.apache.spark.sql.DataFrame = [city: string, min_temp: float ... 2 more fields]\nendTime: Long = 7408774665618\nduration: Double = 1725.356882556\nExecution time: 1725.356882556 seconds\n"}]},"apps":[],"jobName":"paragraph_1712688196942_622778629","id":"20240409-184316_1234592390","dateCreated":"2024-04-09T18:43:16+0000","dateStarted":"2024-04-10T21:56:08+0000","dateFinished":"2024-04-10T22:25:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4606"},{"user":"anonymous","dateUpdated":"2024-04-10T21:56:08+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1712688299084_856426836","id":"20240409-184459_413077939","dateCreated":"2024-04-09T18:44:59+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:4607"}],"name":"Untitled Note 1","id":"2JUHB343F","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}