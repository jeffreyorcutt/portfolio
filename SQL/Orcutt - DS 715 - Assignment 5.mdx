/* Jeff Orcutt
 * DS 715
 * 18 OCT 2023
 * Assignment 5 */


/* 1) Aggregates by combinations of supplier name and product name? */

SELECT NON EMPTY {
		[Measures].[Price - Tb Transactions],
		[Measures].[Quantity - Tb Transactions] } ON COLUMNS,
	NON EMPTY {
		([Tb Supplier].[Name].[Name].ALLMEMBERS *
		[Tb Product].[Name].[Name].ALLMEMBERS) } ON ROWS
	FROM [DS715]
GO
	/* this Go is giving me issues...not sure why*/

/*2) Aggregates by supplier states?*/
SELECT NON EMPTY {
		[Measures].[Quantity - Tb Transactions],
		[Measures].[Tb Transactions Count],
		[Measures].[Price - Tb Transactions] } ON COLUMNS,
	NON EMPTY {
		[Tb Supplier].[State].[State].ALLMEMBERS } ON ROWS
	FROM [DS715]
GO

/*3) Number of transactions by supplier-city and consumer-city combinations? */
SELECT NON EMPTY {
		[Measures].[Tb Transactions Count] } ON COLUMNS,
	NON EMPTY {
		([Tb Supplier].[City].[City].ALLMEMBERS *
		[Tb Consumer].[City].[City].ALLMEMBERS) } ON ROWS
	FROM [DS715]
GO

/* 4) Name of each product and quantity Wisconsin suppliers sold of that
product? */
SELECT NON EMPTY {
		([Measures].[Quantity - Tb Transactions])
		} ON COLUMNS,
	NON EMPTY {
		([Tb Supplier].[State].[Wisconsin],
		[Tb Product].[Name].[Name].ALLMEMBERS) } ON ROWS
	FROM [DS715]
GO

/* 5) Quantity of sales aggregated by product and supplier state? */
SELECT NON EMPTY {
	([Measures].[Quantity - Tb Transactions]) 
		} ON COLUMNS,
	NON EMPTY {
		([Tb Product].[Name].[Name],
		[Tb Supplier].[State].[State])} ON ROWS
	FROM [DS715]
GO

/* 6) Quantity of computer sales aggregated by suppliers in Wisconsin? */
SELECT NON EMPTY {
		([Measures].[Quantity - Tb Transactions],	
		[Tb Product].[Name].[Name].Computer)} ON COLUMNS,
	NON EMPTY {
		([Tb Supplier].[State].[Wisconsin]) } ON ROWS
	FROM [DS715]
GO

/* 7) Quantity of auto sales by each supplier from Wisconsin to each auto
consumer in Illinois? */
SELECT NON EMPTY {
	([Measures].[Quantity - Tb Transactions],
		[Tb Product].[Name].[Name].Auto,
		[Tb Consumer].[State].Illinois)} ON COLUMNS,
	NON EMPTY {
		([Tb Supplier].[Name].[Name].ALLMEMBERS,
		[Tb Consumer].[Name].[Name].ALLMEMBERS,
		[Tb Supplier].[State].[Wisconsin]) } ON ROWS
	FROM [DS715]
GO

/* 8) Quantity of each product sold by each supplier in Madison to each
consumer in Illinois? */
SELECT NON EMPTY {
	([Measures].[Quantity - Tb Transactions],
		[Tb Product].[Name].[Name].ALLMEMBERS,
		[Tb Consumer].[State].Illinois)} ON COLUMNS,
	NON EMPTY {
		([Tb Supplier].[Name].[Name].ALLMEMBERS,
		[Tb Consumer].[Name].[Name].ALLMEMBERS,
		[Tb Supplier].[City].[Madison]) } ON ROWS
	FROM [DS715]
GO

/* 9) Quantity of each product sold by supplier Bernstein to consumers in
Chicago? */
SELECT NON EMPTY {
	([Measures].[Quantity - Tb Transactions],
		[Tb Consumer].[City].Chicago)} ON COLUMNS,
	NON EMPTY {
		([Tb Supplier].[Name].[Bernstein], 
		[Tb Product].[Name].[Name].ALLMEMBERS) } ON ROWS
	FROM [DS715]
GO
/* 10) Quantity of milk sold by supplier Bernstein to each of his milk
consumers in Chicago? */
SELECT NON EMPTY {
	([Measures].[Quantity - Tb Transactions],
		[Tb Consumer].[City].Chicago)} ON COLUMNS,
	NON EMPTY {
		([Tb Supplier].[Name].[Bernstein], 
		[Tb Consumer].[Name].[Name].ALLMEMBERS,
		[Tb Product].[Name].[Milk]) } ON ROWS
	FROM [DS715]
GO
/* 11) (Extra Credit 3%) For each product list quantity sold by suppliers in
Madison to consumers in Chicago versus quantity sold by suppliers in
Chicago to consumers in Madison (result columns will be: product name,
quantity Madison_Chicago, quantity Chicago_Madison)? */

/* I played with this for hours - the answer for this question exist online but I don't cheat. 
 * Here's the best I could do. I just don't know how to combine two distinct queries yet. */

 SELECT NON EMPTY { 
	[Measures].[Quantity - Tb Transactions] } ON COLUMNS,
	NON EMPTY { ([Tb Product].[Name].[Name].ALLMEMBERS ) } 
		DIMENSION PROPERTIES MEMBER_CAPTION, MEMBER_UNIQUE_NAME ON ROWS 
	FROM ( 
		SELECT ( { [Tb Consumer].[City].&[Chicago] } ) ON COLUMNS 
		FROM ( 
			SELECT ( { [Tb Supplier].[City].&[Madison] } ) ON COLUMNS 
			FROM [DS715])) 
	WHERE ( [Tb Supplier].[City].&[Madison], [Tb Consumer].[City].&[Chicago] )
GO
SELECT NON EMPTY { 
	[Measures].[Quantity - Tb Transactions] } ON COLUMNS,
	NON EMPTY { ([Tb Product].[Name].[Name].ALLMEMBERS ) } 
		DIMENSION PROPERTIES MEMBER_CAPTION, MEMBER_UNIQUE_NAME ON ROWS 
	FROM ( 
		SELECT ( { [Tb Consumer].[City].&[Madison] } ) ON COLUMNS 
		FROM ( 
			SELECT ( { [Tb Supplier].[City].&[Chicago] } ) ON COLUMNS 
			FROM [DS715])) 
	WHERE ( [Tb Supplier].[City].&[Chicago], [Tb Consumer].[City].&[Madison] )
